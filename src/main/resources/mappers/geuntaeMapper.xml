<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mappers.geuntaeMapper">
	
	<insert id="insertGotowork" statementType="CALLABLE" parameterType="Geuntae"  >
		{call [동림].[dbo].[UP_출근처리](
			#{sawonCode, mode=IN, jdbcType=VARCHAR, javaType=string},
			#{outworkYN, mode=IN, jdbcType=CHAR, javaType=string},
			#{gotoworkMethod, mode=IN, jdbcType=CHAR, javaType=string},
			#{lat, mode=IN, jdbcType=FLOAT, javaType=float},
			#{lng, mode=IN, jdbcType=FLOAT, javaType=float},
			#{gotoworkTime, mode=OUT, jdbcType=VARCHAR, javaType=string}
		)}
	</insert>
	
	<update id="updateOffwork" statementType="CALLABLE" parameterType="Geuntae">
		{call [동림].[dbo].[UP_퇴근처리](
			#{sawonCode, mode=IN, jdbcType=VARCHAR, javaType=string},
			#{offworkMethod, mode=IN, jdbcType=CHAR, javaType=string},
			#{lat, mode=IN, jdbcType=FLOAT, javaType=float},
			#{lng, mode=IN, jdbcType=FLOAT, javaType=float},
			#{workContent, mode=IN, jdbcType=VARCHAR, javaType=string},
			#{outworkContent, mode=IN, jdbcType=VARCHAR, javaType=string},
			#{offworkTime, mode=OUT, jdbcType=VARCHAR, javaType=string},
			#{gotoworkTime, mode=OUT, jdbcType=VARCHAR, javaType=string}
		)}
	</update>
	
	<select id="selectMyTodayGotowork" parameterType="string" resultType="map">
		select count(근태코드) as cnt, datepart(hour, getDate()) as hr
		  from [동림].[dbo].[근태]
		 where 사원코드 = #{sawonCode}
		   and DATEDIFF(DD, getDate(), 출근시간) = 0
	</select>
	
	<select id="selectTime" parameterType="map" resultType="int">
		<choose>
		<when test="type == 'HOUR'">
		select datepart(HOUR, getDate())
		</when>
		<when test="type == 'MINUTE'">
		select datepart(MINUTE, getDate())
		</when>
		</choose>
	</select>
	
	<select id="selectMyTodayOffwork" parameterType="int" resultType="int">
		select [동림].[dbo].[UF_퇴근처리](#{sawonCode})
	</select>
	
	<select id="selectGeuntaeDetail" parameterType="map" resultType="map">
	
	</select>
</mapper>
